{"ast":null,"code":"var _jsxFileName = \"/Users/zh/Desktop/vote/vote-react/src/hooks.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$();\n\nimport { useState, useCallback, useMemo, useEffect, useContext } from 'react';\nimport { UserContext } from './CurrentUserInfo';\nimport { useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport RequireLogin from './RequireLogin';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function useInput(init = '') {\n  _s();\n\n  var [value, setValue] = useState(init);\n  var onChange = useCallback(function onChange(e) {\n    setValue(e.target.value);\n  }, []);\n  return {\n    value,\n    onChange\n  };\n}\n\n_s(useInput, \"KrmnyqKVGUGQSlrXBQmDgla2thM=\");\n\nexport function useBooleanInput(init = false) {\n  _s2();\n\n  var [checked, setChecked] = useState(init);\n  var onChange = useCallback(function onChange(e) {\n    setChecked(e.target.checked);\n  }, []);\n  return {\n    checked,\n    onChange\n  };\n}\n\n_s2(useBooleanInput, \"MghoiN9n/tjkPKOyCRGmHCOgS3s=\");\n\nexport function useQuery() {\n  _s3();\n\n  var search = useLocation().search;\n  return useMemo(() => new URLSearchParams(search), [search]);\n}\n\n_s3(useQuery, \"z3d/mcTWC4E3z8BNMd0PwL5/N3w=\", false, function () {\n  return [useLocation];\n});\n\nexport function useAxios(config) {\n  _s4();\n\n  var [data, setData] = useState(); // 用来存放请求结果的\n\n  var [error, setError] = useState(); // 用来存放错误结果的\n\n  var [loading, setLoading] = useState(true); // 用来存放是否还在加载中\n\n  var [i, setI] = useState(0);\n  useEffect(() => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    var req = axios({ ...config,\n      cancelToken: source.token\n    });\n    req.then(res => {\n      if (res.data.code == 0) {\n        setData(res.data.result);\n        setError(null);\n      } else {\n        setError(res.data.msg);\n      }\n\n      setLoading(false);\n    }).catch(e => {\n      setError(e.toString());\n      setLoading(false);\n    });\n    return () => source.cancel();\n  }, [config.url, i]);\n  var update = useCallback(function update() {\n    setLoading(true);\n    setI(i => i + 1);\n  }, []);\n  return {\n    data,\n    loading,\n    error,\n    update\n  };\n} // 拿到当前登陆用户的业务hook\n\n_s4(useAxios, \"CP0/e+R2ia6ToubSmspjUSaFLZY=\");\n\nexport function useUser() {\n  _s5();\n\n  return useContext(UserContext);\n} // 强制登陆的高阶组件，用它包裹的组件必须登陆才能显示\n\n_s5(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function forceLogin(Comp) {\n  var _s6 = $RefreshSig$(),\n      _Comp$displayName;\n\n  function ForceLoginComp(props) {\n    _s6();\n\n    var userInfo = useUser();\n\n    if (userInfo.loading) {\n      return null;\n    }\n\n    if (userInfo.error) {\n      return /*#__PURE__*/_jsxDEV(RequireLogin, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Comp, { ...props,\n      userInfo: userInfo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 12\n    }, this);\n  }\n\n  _s6(ForceLoginComp, \"lxeFcid5QSsbUdffvmePeNN7wLs=\", false, function () {\n    return [useUser];\n  });\n\n  ForceLoginComp.displayName = 'ForceLogin' + ((_Comp$displayName = Comp.displayName) !== null && _Comp$displayName !== void 0 ? _Comp$displayName : Comp.name);\n  return ForceLoginComp;\n}","map":{"version":3,"sources":["/Users/zh/Desktop/vote/vote-react/src/hooks.js"],"names":["useState","useCallback","useMemo","useEffect","useContext","UserContext","useLocation","axios","RequireLogin","useInput","init","value","setValue","onChange","e","target","useBooleanInput","checked","setChecked","useQuery","search","URLSearchParams","useAxios","config","data","setData","error","setError","loading","setLoading","i","setI","CancelToken","source","req","cancelToken","token","then","res","code","result","msg","catch","toString","cancel","url","update","useUser","forceLogin","Comp","ForceLoginComp","props","userInfo","displayName","name"],"mappings":"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","sourcesContent":["import { useState, useCallback, useMemo, useEffect, useContext } from 'react'\r\nimport { UserContext } from './CurrentUserInfo'\r\nimport { useLocation } from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport RequireLogin from './RequireLogin'\r\n\r\n\r\nexport function useInput(init = '') {\r\n  var [value, setValue] = useState(init)\r\n\r\n  var onChange = useCallback(function onChange(e) {\r\n    setValue(e.target.value)\r\n  }, [])\r\n\r\n  return {\r\n    value, onChange\r\n  }\r\n}\r\n\r\nexport function useBooleanInput(init = false) {\r\n  var [checked, setChecked] = useState(init)\r\n\r\n  var onChange = useCallback(function onChange(e) {\r\n    setChecked(e.target.checked)\r\n  }, [])\r\n\r\n  return {checked, onChange}\r\n}\r\n\r\nexport function useQuery() {\r\n  var search = useLocation().search\r\n  return useMemo(() => new URLSearchParams(search), [search])\r\n}\r\n\r\nexport function useAxios(config) {\r\n  var [data, setData] = useState() // 用来存放请求结果的\r\n  var [error, setError] = useState() // 用来存放错误结果的\r\n  var [loading, setLoading] = useState(true) // 用来存放是否还在加载中\r\n  var [i, setI] = useState(0)\r\n\r\n  useEffect(() => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source();\r\n\r\n    var req = axios({\r\n      ...config,\r\n      cancelToken: source.token\r\n    })\r\n\r\n    req.then(res => {\r\n      if (res.data.code == 0) {\r\n        setData(res.data.result)\r\n        setError(null)\r\n      } else {\r\n        setError(res.data.msg)\r\n      }\r\n      setLoading(false)\r\n    }).catch(e => {\r\n      setError(e.toString())\r\n      setLoading(false)\r\n    })\r\n\r\n    return () => source.cancel()\r\n  }, [config.url, i])\r\n\r\n  var update = useCallback(function update() {\r\n    setLoading(true)\r\n    setI(i => i + 1)\r\n  }, [])\r\n\r\n  return {\r\n    data,\r\n    loading,\r\n    error,\r\n    update,\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n// 拿到当前登陆用户的业务hook\r\nexport function useUser() {\r\n  return useContext(UserContext)\r\n}\r\n\r\n\r\n// 强制登陆的高阶组件，用它包裹的组件必须登陆才能显示\r\nexport function forceLogin(Comp) {\r\n  function ForceLoginComp(props) {\r\n    var userInfo = useUser()\r\n    if (userInfo.loading) {\r\n      return null\r\n    }\r\n    if (userInfo.error) {\r\n      return <RequireLogin />\r\n    }\r\n    return <Comp {...props} userInfo={userInfo}/>\r\n  }\r\n\r\n  ForceLoginComp.displayName = 'ForceLogin' + (Comp.displayName ?? Comp.name)\r\n\r\n  return ForceLoginComp\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
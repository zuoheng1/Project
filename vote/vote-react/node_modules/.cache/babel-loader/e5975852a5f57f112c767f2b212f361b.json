{"ast":null,"code":"var _jsxFileName = \"/Users/zh/Desktop/vote/vote-react/src/CreateVote.js\",\n    _s = $RefreshSig$();\n\n// 真正用于创建投票的界面\nimport { useImmer } from 'use-immer';\nimport { useMemo } from 'react';\nimport { useInput, useBooleanInput, useQuery, forceLogin } from './hooks';\nimport { useHistory } from 'react-router-dom';\nimport axios from 'axios';\nimport dayjs from 'dayjs';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction CreateVote({\n  userInfo\n}) {\n  _s();\n\n  var [options, setOptions] = useImmer(['', '']);\n  var title = useInput();\n  var desc = useInput();\n  var deadline = useInput(useMemo(() => dayjs().add(1, 'year').format('YYYY-MM-DDTHH:mm'), []));\n  var anonymous = useBooleanInput();\n  var history = useHistory();\n  var query = useQuery();\n\n  function remove(idx) {\n    setOptions(options => {\n      options.splice(idx, 1);\n    });\n  }\n\n  function setOption(idx, val) {\n    setOptions(options => {\n      options[idx] = val;\n    });\n  }\n\n  async function create() {\n    var vote = {\n      title: title.value,\n      desc: desc.value,\n      options: options,\n      deadline: deadline.value,\n      anonymous: anonymous.checked,\n      multiple: query.get('multiple') === '1' ? true : false\n    };\n    console.log(vote);\n\n    try {\n      debugger;\n      var res = await axios.post('/vote', vote);\n      var createdVote = res.data.result; // data里应该有创建好的投票信息，如：创建者，投票id\n\n      console.log(createdVote);\n      history.push('/view-vote/' + createdVote.voteId);\n    } catch (e) {\n      throw e;\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u6295\\u7968\\u6807\\u9898\",\n        ...title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u8865\\u5145\\u63CF\\u8FF0(\\u9009\\u586B)\",\n        ...desc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), options.map((option, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u9009\\u9879\",\n        value: option,\n        onChange: e => setOption(idx, e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        tabIndex: \"-1\",\n        onClick: () => remove(idx),\n        children: \"-\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }, this)]\n    }, idx, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setOptions(options => {\n          options.push('');\n        }),\n        children: \"\\u6DFB\\u52A0\\u9009\\u9879\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"\\u622A\\u6B62\\u65E5\\u671F:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"datetime-local\",\n        ...deadline\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"\\u533F\\u540D\\u6295\\u7968:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        ...anonymous\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: create,\n        children: \"\\u521B\\u5EFA\\u6295\\u7968\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateVote, \"Cwl4jc4UCgTPCjUZ8ee+MvCG4iQ=\", false, function () {\n  return [useImmer, useInput, useInput, useInput, useBooleanInput, useHistory, useQuery];\n});\n\n_c = CreateVote;\nexport default _c2 = forceLogin(CreateVote);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CreateVote\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/zh/Desktop/vote/vote-react/src/CreateVote.js"],"names":["useImmer","useMemo","useInput","useBooleanInput","useQuery","forceLogin","useHistory","axios","dayjs","CreateVote","userInfo","options","setOptions","title","desc","deadline","add","format","anonymous","history","query","remove","idx","splice","setOption","val","create","vote","value","checked","multiple","get","console","log","res","post","createdVote","data","result","push","voteId","e","map","option","target"],"mappings":"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","sourcesContent":["// 真正用于创建投票的界面\r\n\r\nimport { useImmer } from 'use-immer'\r\nimport { useMemo } from 'react'\r\nimport { useInput, useBooleanInput, useQuery, forceLogin } from './hooks'\r\nimport { useHistory } from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport dayjs from 'dayjs'\r\n\r\nfunction CreateVote({ userInfo }) {\r\n  var [options, setOptions] = useImmer(['', ''])\r\n  var title = useInput()\r\n  var desc = useInput()\r\n  var deadline = useInput(useMemo(() => dayjs().add(1, 'year').format('YYYY-MM-DDTHH:mm'), []))\r\n  var anonymous = useBooleanInput()\r\n  var history = useHistory()\r\n  var query = useQuery()\r\n\r\n  function remove(idx) {\r\n    setOptions(options => {\r\n      options.splice(idx, 1)\r\n    })\r\n  }\r\n\r\n  function setOption(idx, val) {\r\n    setOptions(options => {\r\n      options[idx] = val\r\n    })\r\n  }\r\n\r\n  async function create() {\r\n    var vote = {\r\n      title: title.value,\r\n      desc: desc.value,\r\n      options: options,\r\n      deadline: deadline.value,\r\n      anonymous: anonymous.checked,\r\n      multiple: query.get('multiple') === '1' ? true : false,\r\n    }\r\n    console.log(vote)\r\n\r\n    try {\r\n      debugger\r\n\r\n      var res = await axios.post('/vote', vote)\r\n      var createdVote = res.data.result // data里应该有创建好的投票信息，如：创建者，投票id\r\n      console.log(createdVote)\r\n      history.push('/view-vote/' + createdVote.voteId)\r\n    } catch (e) {\r\n      throw e\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>创建投票</h1>\r\n      <div><input type=\"text\" placeholder=\"投票标题\" {...title}/></div>\r\n      <div><input type=\"text\" placeholder=\"补充描述(选填)\" {...desc}/></div>\r\n\r\n      {\r\n        options.map((option, idx) =>\r\n          <div key={idx}>\r\n            <input type=\"text\" placeholder=\"选项\" value={option} onChange={e => setOption(idx, e.target.value)}/>\r\n            <button tabIndex=\"-1\" onClick={() => remove(idx)}>-</button>\r\n          </div>\r\n        )\r\n      }\r\n      <div><button onClick={() => setOptions(options => { options.push('') })}>添加选项</button></div>\r\n      <div>截止日期:<input type=\"datetime-local\" {...deadline} /></div>\r\n      <div>匿名投票:<input type=\"checkbox\" {...anonymous} /></div>\r\n      <div><button onClick={create}>创建投票</button></div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default forceLogin(CreateVote)\r\n"]},"metadata":{},"sourceType":"module"}